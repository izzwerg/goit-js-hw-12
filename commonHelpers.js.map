{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst form = document.querySelector('.form');\nform.addEventListener('submit', imageSearch);\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst moreButton = document.querySelector('.is-hidden');\nmoreButton.addEventListener('click', addMoreImages);\nconst API_KEY = '11329962-6436ba51ddb58bb96deed169a';\nlet pageNumber;\nlet searchTerm;\nlet lightbox;\n\naxios.defaults.baseURL = 'https://pixabay.com/api';\n\nasync function imageSearch(e) {\n  pageNumber = 1;\n  e.preventDefault();\n  gallery.innerHTML = '';\n  loader.classList.add('is-visible');\n  moreButton.classList.remove('is-visible');\n\n  const form = e.currentTarget;\n  searchTerm = form.elements.searchTerm.value;\n\n  try {\n    let images = await getImages(searchTerm);\n\n    if (images.total === 0) {\n      noFoundMessage();\n      return;\n    } else {\n      addMarkup(images);\n      lightbox = new SimpleLightbox('.gallery a');\n      lightbox.refresh();\n    }\n  } catch (error) {\n    errorMessage(error.message);\n  } finally {\n    form.reset();\n  }\n}\n\nasync function addMoreImages() {\n  loader.classList.add('is-visible');\n  try {\n    let images = await getImages(searchTerm);\n    addMarkup(images);\n    lightbox.refresh();\n    let elem = gallery.querySelector('li');\n    let rect = elem.getBoundingClientRect();\n    scrollBy({\n      top: rect.height * 2 + 48,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    errorMessage(error.message);\n  }\n}\n\nfunction addMarkup(images) {\n  moreButton.classList.remove('is-visible');\n  let markup = '';\n  for (const image of images.hits) {\n    markup += createMarkup(image);\n  }\n  loader.classList.remove('is-visible');\n  gallery.insertAdjacentHTML('beforeend', markup);\n  checkMore(images.totalHits);\n}\n\nfunction checkMore(maxImages) {\n  if (gallery.querySelectorAll('li').length < maxImages) {\n    moreButton.classList.add('is-visible');\n  } else {\n    noMoreMessage();\n  }\n}\n\nasync function getImages(searchTerm) {\n  const urlParams = new URLSearchParams({\n    key: API_KEY,\n    q: searchTerm,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: 40,\n    page: pageNumber,\n  });\n\n  const response = await axios.get(`/?${urlParams}`);\n  pageNumber++;\n  return response.data;\n}\n\nfunction createMarkup({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n        </a>\n        <div class=\"gallery-details\">\n            <div class=\"detail\"><img class=\"gallery-logo\" src=\"like.png\" /> <p class=\"gallery-text\">${likes}</p></div>\n            <div class=\"detail\"><img class=\"gallery-logo\" src=\"viev.png\" /> <p class=\"gallery-text\">${views}</p></div>\n            <div class=\"detail\"><img class=\"gallery-logo\" src=\"comment.png\" /> <p class=\"gallery-text\">${comments}</p></div>\n            <div class=\"detail\"><img class=\"gallery-logo\" src=\"download.png\" /> <p class=\"gallery-text\">${downloads}</p></div>\n        </div>\n    </li>`;\n}\n\nfunction noFoundMessage() {\n  iziToast.show({\n    position: 'topRight',\n    messageColor: 'white',\n    iconUrl: 'error.svg',\n    iconColor: 'white',\n    color: '#EF4040',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n  });\n  loader.classList.remove('is-visible');\n}\n\nfunction errorMessage(msg) {\n  iziToast.show({\n    position: 'topRight',\n    messageColor: 'white',\n    iconUrl: 'attention.png',\n    iconColor: 'white',\n    color: '#EF4040',\n    message: msg,\n  });\n  loader.classList.remove('is-visible');\n}\n\nfunction noMoreMessage() {\n  iziToast.show({\n    position: 'topRight',\n    messageColor: 'white',\n    iconUrl: 'fin.png',\n    iconColor: 'white',\n    color: '#4E75FF',\n    message: \"We're sorry, but you've reached the end of search results.\",\n  });\n}\n"],"names":["form","imageSearch","gallery","loader","moreButton","addMoreImages","API_KEY","pageNumber","searchTerm","lightbox","axios","images","getImages","noFoundMessage","addMarkup","SimpleLightbox","error","errorMessage","rect","markup","image","createMarkup","checkMore","maxImages","noMoreMessage","urlParams","response","webformatURL","largeImageURL","tags","likes","views","comments","downloads","iziToast","msg"],"mappings":"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"}